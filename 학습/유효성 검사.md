# 유효성 검사 

## 유효성 검사의 위치
유효성 검사는 어디에서 하는게 적절할까?
Model? View? Controller? 

프리코스를 진행하면서 가장 큰 고민거리였던 유효성 검사의 위치. 

처음에는 컨트롤러에 두었고 추후에는 모델에 검증을 두었는데, 한 부분에만 검증을 진행하는 것이 과연 옳은 방식인가 의문이 들었다.
사실 가장 좋은 방법은 모든 단계에 유효성 검사를 적용하는 것이라 생각한다. 하지만 그렇게 작성하면 똑같은 검증을 계속 반복해서 사용하며 비효율적으로 코드를 작성하게 된다.
그래서 나는 각각의 단계에서 모두 검증을 진행하는 대신, 각 계층이 담당하는 검증의 종류가 다르도록 기준을 세워보았다.

### View 
현재는 콘솔에서 입력받고 있지만 html을 사용해서 웹 페이지에서 입력을 받았다고 생각해보자.
우리는 사용자에게 잘못된 값이 입력되었다고 경고 메세지를 보낼 의무가 있고, 검증을 통해 오류 메세지를 보낼 것이다.
이 때 내부 데이터에 접근하지 않고 바로 웹 페이지에서 검증할 수 있는 부분에는 뭐가 있을까?

이런 부분은 데이터에 접근해서 해당 값이 가져야할 기준, 다른 데이터를 확인하지 않고도 검사할 수 있을 것이다. 
-> 공백이 입력되었을 때

> View : 입력받은 값이 어떤 값이 될지 몰라도 검증할 수 있는 부분 검증하기 -> 최소한만 검증하기 


### Model 
model은 그 자체로 무결한 데이터를 가지고 있어야 한다.
controller에서 정제된 데이터만 줄 것이라고 믿으면 스스로 데이터를 무결하게 관리할 수 없고, controller에게 너무 많은 의존성을 갖게된다.

자동차 경주 게임을 처음 구현할 때도 이런 문제가 발생했었다. 
모든 검증을 controller 단에서 하다보니, 자동차 이름을 저장하는 Car 모델은 스스로 올바른 값을 가진지 확인할 수 없고 controller가 준 값이 올바를 것이라고 그저 믿고 사용해야 했다.

-> model이 스스로의 값을 스스로 다루지 못하고, 다른 부분에 의존하게 된다. -> 객체지향적이지 못한 방식이라고 생각

-> 테스트를 작성할 때 Car 자체가 무결한 값을 가질 수 있는지 테스트 할 수 없음 -> controller 단에서 체크해야함

해당 모델이 관리할 값(상태)은 해당 모델이 검증하고 관리할 수 있어야 한다고 생각했다.
그래서 controller에 작성한 모든 검증을 model 내부로 이동시켰고, 모델은 스스로 값을 검증하게 되었다.

> Model : 해당 모델이 가지게 될 값(상태)에게 적용되어야 하는 모든 검증 

### Controller 
데이터를 입력받아 프로그램으로 가져왔다. 해당 데이터를 처리하고 조작하기 위해서 적절한 모델에게 데이터를 전달해야한다.
데이터를 전달하기 전에 어떤 검증을 수행할 수 있을까? 

원래 모든 검증을 controller에서 진행했었는데, 대부분의 검증을 model에서 진행하도록 바꾸다보니 controller에서 검증할 부분이 없어졌다.
controller는 모델에게 정제된 데이터를 제공할 의무가 있는 것도 맞지만, model은 그 자체로 무결해야 하기 때문에 스스로를 검증할 수 있어야 한다.
똑같은 검증을 두 곳 모두에 적용하는 것이 가장 좋아보이지만 중복된 로직을 적용해야 해서 고민이 많이 되었다.

결국 모델 내부에서 다뤄야 할 검증은 model에서 진행하고 controller는 데이터를 전달하는 역할만 맡게 하기로 결정내렸다.

model에서 다루지 않을 값은 이전과 똑같이 controller에서 검증하였다.
전진을 몇 번 진행할 것인지에 대한 round 입력값은 핵심 상태로 다뤄져서 특정 행동을 통해 값이 변경된다거나, 해당 값이 반복적으로 필요하지 않다.
이렇게 한 번 사용되는 값을 위해 model을 만들 필요는 없기 때문에 이런 값들은 controller 내부에서 다루기로 결정하였다.

그저 반복 횟수로 사용되고 끝날 뿐 -> 어떤 행동을 통해 변경될 중요한 값이 아님 -> 저장해서 사용할 필요없음 -> 컨트롤러에서 검증하고 사용 

> Controller : model에 저장할 값 이외에 사용될 입력값


---
## 참고
(https://chiki-cha.tistory.com/150)
(https://blog.barogo.io/%EA%B0%9C%EB%B0%9C%EC%9D%B8%ED%84%B4-validation%EC%9D%98-%EC%A0%81%EC%A0%88%EC%84%B1-79ed23f28a72)