# 로또를 다시 풀어보며 고민한 부분 

### 객체 간 결합도를 낮추기 위해서는 어떻게 해야할까?

프리코스에서 나눴던 구조와 다르게 이번에는 결과와 관련된 정보들을 만들어내고 관리하는 RankCalculator라는 클래스를 만들어 사용하였다.
결과를 LottoBundle에서 구하는 것보다 더 이해하기 쉽고 각자의 클래스가 맡은 책임도 나누어져 있어서 더 좋다고 생각했는데, 다 풀고나니까 결합도가 너무 높지 않은가? 생각이 들었다.
내부에서 lottoBundle, winningNumbers 인스턴스를 받아 해당 인스턴스의 메서드를 호출해서 기능을 구현하고 있었는데, 정말 필요한 정보만 받는게 아니라 인스턴트 전체를 받아서 RankCalculator가 너무 많은 정보를 알고 있는 것 같았다.

그래서 컨트롤러에서 인스턴스를 전달하는게 아니라, 인스턴스에서 받아온 데이터만을 전달하도록 수정해주었다.
```js
const rankCalculator = new RankCalculator({
    lottoBundle: this.#lottoBundle.getLottoList(),
    winningLotto: this.#winningNumbers.getWinningLotto(),
    bonusNumber: this.#winningNumbers.getBonusNumber(),
});
```

이전보다는 나아졌지만 여전히 의문이 남아있다.
- Lotto에 대한 결합성은 여전히 남아있는데, 이정도는 괜찮은 것일까? 아니면 다른 방법이 있을까?
- getter로 데이터를 가져와서 전달하고 있는데, 이 때 getter는 적절하게 사용되고 있을까?
  - 객체 내부에서 해당 데이터를 다뤄야 한다고 했는데 로또 번호와 당첨 번호, 보너스 번호를 비교하려면 어쩔 수 없이 한쪽에서는 getter를 통해 데이터를 가져와 다른 쪽에 넣어줘야한다.
  - 그렇다고 getter를 지양하기 위해서 해당 값들을 클래스 내부가 아닌 컨트롤러에서 다루는 것도 이상하다.


### 단일 책임 도대체 어디까지?
순위를 계산하고 수익률을 계산하는 기능을 rankCalculator에서 담당하고 있다.
순위 계산 / 수익률 계산 이라는 2가지 기능이 있으니 클래스를 분리해야 할까?

순위 계산 클래스는 여러 번호들을 비교해 일치하는 개수 확인 -> 순위 계산 -> 해당 순위를 이용해서 수익률을 만들어내는 작업을 수행하고 있다.
수익은 순위 결과가 있어야만 계산할 수 있고, 수익률 계산에 대한 클래스를 따로 만들면 해당 클래스는 결국 순위값을 가지고 조작하게 되는데 순위값을 다루는 클래스가 이미 있는데 굳이 분리해야하나? 라는 생각에 결국 그대로 두었다.
매번 과제를 할 때마다 단일 책임에 대해 고민하게 되는 것 같다. 객체지향의 길은 멀고 험난하다..


### Validator(검증)은 어디까지 세분화해서 작성해야 할까?
5시간 타임 어택을 하면서 작성하는데 설계 단계에서 Validation을 너무 쪼개놔서 작성하는데 머리가 아팠다.
숫자를 확인하는 로직만 봐도 숫자인지 / 정수인지 / 양수인지 / 범위 내의 숫자인지 이렇게 여러개로 쪼개놔서 일일히 작성해줘야 했다.

사용자에게 에러 메세지를 보낼때 정확하게 어떤 부분이 잘못된 것인지 자세하게 알려주고 싶다는 마음에 이렇게 작성했는데 로직만 많고 복잡해지고 실제로 도움은 안된 것 같다.
올바른 값이 들어왔는지 확인하는 게 목적이니까 조금 더 큰 단위로 묶어서 검증하도록 수정하려고 한다.


### Validation과 Validator의 위치 
여태 검증 로직은 Validator 객체의 메서드로 구현하고, 실제 호출해서 사용하는 부분은 모델이나 컨트롤러에 작성하곤 했다.
호출 부분을 Validator 안에 작성할 수도 있겠지만 컨트롤러와 모델에서 어떤 검증을 하고있는 것인지 보여주고 싶기도 했고, 값을 검증하는 것도 해당 객체의 역할이라고 생각했기 때문에 이렇게 작성했다.
그러다 보니까 검증 로직이 컨트롤러, 모델 이곳 저곳에 사용되고 오히려 로직이 복잡해 보이는 것 같아서 이번에는 Validator 안에 다 작성해보았는데 어떤게 정답이라고 할 수는 없을 것 같다.

나는 해당 값을 검증하는 부분에서 Validation 메서드들을 호출하는 것이 더 낫다고 생각한다.
Validator 객체 내부에서 작성하게 되면 해당 값을 검증하는 로직이 전적으로 Validator에 의존하게 되고, 해당 값을 검증하는 방식을 바꾸거나 추가하고 싶으면 모델 내부가 아니라 Validator를 조작해야 해서 이상하다고 생각하였다.
다음에는 다시 해당 값이 사용되는 부분에 검증을 작성해야겠다.


### 상수 객체를 더 효율적으로 사용할 수 있는 방법은 없을까?
'당첨 번호와 일치하는 번호의 개수 <-> 순위 <-> 가격'은 서로 연관성이 있고 프로그램 내에서도 한가지 값을 가지고 다른 값을 유추할 수 있어야 했다.
그러나 보너스 번호가 있기 때문에 2등과 3등의 당첨 번호 일치 개수가 같은 문제가 있어서 당첨 개수 -> 순위 이렇게 바로 변환하는 것이 매우 어려웠다.

...


